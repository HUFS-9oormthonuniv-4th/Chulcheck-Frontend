**핵심 원칙: 서버 컴포넌트를 기본으로 사용하고, 꼭 필요한 경우에만 클라이언트 컴포넌트로 전환한다.**

---

**`'use client'` 지시어를 사용하여 클라이언트 컴포넌트로 만들어야 하는 경우:**

1. **상호작용 및 이벤트 리스너 사용 시 (Interactivity & Event Listeners):**
    - `onClick()`, `onChange()`, `onSubmit()` 등 브라우저 이벤트를 처리해야 하는 컴포넌트.
    - **이유:** 이벤트 핸들링 로직은 사용자의 브라우저에서 실행되어야 합니다.
    - **예시:** 버튼, 폼 입력 요소, 드롭다운 메뉴 등 사용자와 직접 상호작용하는 모든 UI 요소.
2. **상태(State) 및 라이프사이클 훅 사용 시 (State & Lifecycle Hooks):**
    - `useState()`, `useReducer()` 훅을 사용하여 컴포넌트 내부 상태를 관리해야 하는 경우.
    - `useEffect()`, `useLayoutEffect()` 훅을 사용하여 마운트/업데이트/언마운트 시 부수 효과(side effect)를 처리해야 하는 경우 (예: API 호출, 이벤트 리스너 등록/해제).
    - **이유:** 이러한 React 훅들은 클라이언트 측 렌더링 및 라이프사이클에 의존합니다.
    - **예시:** 실시간으로 변하는 카운터, 사용자 입력에 따라 동적으로 변하는 UI, 컴포넌트 로드 시 데이터를 받아오는 로직(TanStack Query/SWR 등 상태 관리 라이브러리 내부에서 `useEffect` 사용).
3. **브라우저 전용 API 사용 시 (Browser-Only APIs):**
    - `window` 객체, `document` 객체, `localStorage`, `sessionStorage`, `navigator` (위치 정보 등) 등 브라우저 환경에서만 제공되는 API를 직접 사용해야 하는 경우.
    - **이유:** 서버 환경에서는 이러한 브라우저 API가 존재하지 않습니다.
    - **예시:** 현재 창 크기 감지, 로컬 스토리지에 사용자 설정 저장/로드, Geolocation API 사용.
4. **상태나 효과에 의존하는 커스텀 훅 사용 시 (Custom Hooks using State/Effects):**
    - 내부적으로 `useState`, `useEffect` 등 클라이언트 전용 훅을 사용하는 커스텀 훅을 사용하는 컴포넌트.
    - **이유:** 해당 커스텀 훅 자체가 클라이언트 환경에서 실행되어야 하므로, 이를 사용하는 컴포넌트도 클라이언트 컴포넌트여야 합니다.
    - **예시:** `useWindowSize()`, `useDebounce()` (내부적으로 `useState`, `useEffect` 사용) 같은 커스텀 훅.

---

**서버 컴포넌트로 유지해야 하는 경우 (기본값):**

위의 클라이언트 컴포넌트가 필요한 조건에 해당하지 않는 모든 컴포넌트는 서버 컴포넌트로 유지하는 것이 좋습니다.

- **데이터 가져오기 (Data Fetching):** 서버에서 직접 데이터베이스나 외부 API에 접근하여 데이터를 가져오는 로직 (서버 컴포넌트 내 `async/await` 사용). 보안상 민감한 정보(API 키 등)를 클라이언트에 노출하지 않고 안전하게 처리 가능.
- **정적인 UI 렌더링:** 상태나 상호작용 없이 단순히 데이터를 받아 화면에 표시하는 컴포넌트.
- **백엔드 리소스 직접 접근:** 서버 환경의 라이브러리나 모듈을 직접 사용하는 경우.
- **대규모 의존성 포함:** 클라이언트 자바스크립트 번들 크기에 영향을 주지 않고 서버에서만 사용되는 라이브러리를 포함하는 경우.

---

**가장 중요한 최적화 원칙: 클라이언트 컴포넌트를 최대한 아래로(Leaf Components) 배치하라.**

- 페이지 전체를 `'use client'`로 만들기보다는, **상호작용이 필요한 가장 작은 단위의 컴포넌트만** 클라이언트 컴포넌트로 만듭니다.
- **예시:** 블로그 게시글 페이지
    - 페이지 레이아웃 (`layout.js`) - 서버 컴포넌트
    - 게시글 본문 내용 표시 (`PostContent.js`) - 서버 컴포넌트 (데이터만 받아서 표시)
    - 댓글 목록 표시 (`CommentList.js`) - 서버 컴포넌트
    - **좋아요 버튼 (`LikeButton.js`) - 클라이언트 컴포넌트 (`onClick`, `useState` 필요)**
    - **댓글 입력 폼 (`CommentForm.js`) - 클라이언트 컴포넌트 (`onChange`, `useState`, `onSubmit` 필요)**

이렇게 하면 클라이언트로 전송되는 자바스크립트 양을 최소화하여 초기 로딩 성능을 향상시킬 수 있습니다. 서버 컴포넌트는 클라이언트 컴포넌트를 직접 임포트하고 렌더링할 수 있습니다.
